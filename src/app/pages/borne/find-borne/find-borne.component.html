<body>
<div class="container">
  <div class="row">
    <div class="col">
      <h1 class="mt-5">Trouver une borne autour de soi ðŸ”‹</h1>
    </div>
  </div>
  <div class="row d-flex justify-content-center">
    <div class="col-7 bg-blue my-5">

      <form (ngSubmit)="searchBornes()">
        <div class="mb-3">
          <label for="ville" class="form-label">Ville</label>
          <select class="form-select" aria-label="Default select example" [(ngModel)]="searchCriteria.ville" name="ville">
            <option [ngValue]="null" disabled>Choisissez votre ville</option>
            @for (ville of villesDisponibles; track ville) {
              <option [value]="ville">{{ searchCriteria.ville }}</option>
            }
          </select>
        </div>

        <div class="row d-flex align-items-center position-relative">
          <div class="col-6">
            <label for="startDate" class="form-label">Date de dÃ©but</label>
            <div class="input-group">
              <input #dpFromDate
                     class="form-control"
                     placeholder="yyyy-mm-dd"
                     name="dpFromDate"
                     [value]="formatter.format(searchCriteria.fromDate)"
                     (input)="searchCriteria.fromDate = validateInput(searchCriteria.fromDate, dpFromDate.value)"
                     ngbDatepicker
                     #datepickerFrom="ngbDatepicker" />
              <button class="calendar btn btn-outline-secondary" (click)="datepickerFrom.toggle()" type="button">ðŸ“…</button>
            </div>
          </div>
          <div class="col-6">
            <label for="endDate" class="form-label">Date de fin</label>
            <div class="input-group">
              <input #dpToDate
                     class="form-control"
                     placeholder="yyyy-mm-dd"
                     name="dpToDate"
                     [value]="formatter.format(searchCriteria.toDate)"
                     (input)="searchCriteria.toDate = validateInput(searchCriteria.toDate, dpToDate.value)"
                     ngbDatepicker
                     #datepickerTo="ngbDatepicker" />
              <button class="calendar btn btn-outline-secondary" (click)="datepickerTo.toggle()" type="button">ðŸ“…</button>
            </div>
          </div>
        </div>

        <div class="row d-flex">
          <div class="col-6">
            <label for="startTime" class="form-label">Heure de dÃ©but</label>
            <ngb-timepicker [(ngModel)]="searchCriteria.startTime" name="startTime"></ngb-timepicker>
          </div>
          <div class="col-6">
            <label for="endTime" class="form-label">Heure de fin</label>
            <ngb-timepicker [(ngModel)]="searchCriteria.endTime" name="endTime"></ngb-timepicker>
          </div>
        </div>

        <button class="m-auto mt-5" type="submit">Rechercher<span class="emoji ms-2">âš¡</span></button>
      </form>

    </div>
  </div>

  <div class="row mt-5 d-flex justify-content-center">
    <div class="col-7 bg-blue my-5 p-4">
      <h2 class="text-center mb-4">RÃ©sultats de la recherche :</h2>

      @if (bornes.length === 0) {
        <p class="text-center text-muted">Aucune borne trouvÃ©e pour les critÃ¨res de recherche.</p>
      } @else {
        <div class="row">
          @for (borne of bornes; track borne.id) { <div class="col-md-6 mb-4">
            <div class="card h-100">
              <div class="card-body">
                <h5 class="card-title">{{ borne.nomBorne }}</h5>
                <p class="card-text"><strong>Puissance:</strong> {{ borne.puissance }} kW</p>
                <p class="card-text"><strong>Prix:</strong> {{ borne.prix }} â‚¬/kWh</p>
                <p class="card-text"><strong>Instruction:</strong> {{ borne.instruction }}</p>
                <p class="card-text"><strong>Disponible:</strong> {{ borne.estDisponible ? 'Oui' : 'Non' }}</p>
                @if (borne.lieu) { <p class="card-text"><strong>Ville:</strong> {{ borne.lieu.ville }}</p>
                  <p class="card-text"><strong>Adresse:</strong> {{ borne.lieu.nomRue }}</p>
                }
                <button class="btn btn-primary mt-2">DÃ©tails</button>
              </div>
            </div>
          </div>
          }
        </div>
      }
    </div>
  </div>
</div>
</body>
